
import {
  H1,
  OpenApiRequestBody,
  OpenApiResponse
 } from '@redocly/developer-portal/ui';

# Update Operation
The Update operation is made in response to shopper updates of the Order object. Shoppers can update orders in any sequence (i.e. billing first, shipping first, etc). Each action will make a call to update the eCommerce platform. Fast requires an updated cart from the platform based on changes submitted. 

**The update API is able to update several different top level components of the order.** In the request we send to your server, we will supply _only_ the incremental data. If we send you data, you should check that the item being updated/added is not being duplicated accidentally. We provide unique ids on each item.

We also use the update endpoint to update the status of an order (i.e from a cart to an order, from pending to pending fulfillment, etc.).

## Update Request
<span>
  <p style={{fontFamily:'Courier,monospace', display:'flex',alignItems:'center'}}>
  <div style={{backgroundColor:'cadetblue', color:'white', padding:'3px 5px'}}>POST</div>
  /fast/v1/update
  </p>
</span>

<OpenApiRequestBody definitionId="merchant" pointer="#/components/requestBodies/UpdateRequest" />

## Update Response
### Success (200)
<OpenApiResponse definitionId="merchant" pointer="#/components/responses/UpdateResponse" />

### Error
<OpenApiResponse definitionId="merchant" pointer="#/components/responses/DefaultResponse" />

## Use Cases
Below are business cases that will trigger Fast to call the Update operation to the Seller.

<details><summary><h3>Add an Item to the Cart</h3></summary>
<p>

### Add an Item to the Cart

If shoppers “Return to Store” to add an item to the cart in their Fast Checkout session, the entire Order object will need to be updated. This needs to check if inventory is available. The response should include changes to eligible shipping methods, coupons, etc. based on the new cart contents.

**Request**
```json
{
  "app_id": "31d7ff3a-0128-440e-a5a2-c1e10d4c2d83",
  "type": "ENTITY_TYPE_ORDER",
  "order": {
    "order_id": {
      "value": "863e151e-703e-4da3-b044-a1c874afeda3"
    },
    "is_cart": true,
    "items": [
      {
        "item_id": {
          "value": "e0400168-958b-4a46-bf23-08cb6ee00630"
        },
        "quantity": 1,
        "external_product_id": "canon-powershot-a580M",
        "external_variant_id": "canon-powershot-a580M"
      }
    ],
    "external_id": "b097a63a4f829c6ecc192c3057"
  }
}
```

**Response**
```json
{
  "type": "ENTITY_TYPE_ORDER",
  "order": {
    "order": {
      "id": {
        "value": "863e151e-703e-4da3-b044-a1c874afeda3"
      },
      "external_id": "b097a63a4f829c6ecc192c3057",
      "order_type": "ORDER_TYPE_CART",
      "currency_code": "USD",
      "status": "ORDER_STATUS_CART",
      "bill_to": {
        "first_name": "Solutions",
        "last_name": "Team",
        "email": "solutions@fast.co",
        "phone": "+18005551212",
        "address_1": "100 Park Avenue",
        "city_locality": "New York",
        "state_province_code": "NY",
        "country_code": "US",
        "postal_code": "10017"
      },
      "lines": [
        {
          "id": {
            "value": "2f914efb-0926-46af-86b4-6f7012d3d9bd"
          },
          "external_id": "dc8a000b11e0ac1bd81ed6427a",
          "external_product_id": "canon-eos-50d-bodyM",
          "external_variant_id": "canon-eos-50d-bodyM",
          "quantity": 1,
          "quantity_fulfilled": 1,
          "unit_price": "979.99",
          "discounted_unit_price": "979.99",
          "line_discount_amount": "0",
          "subtotal_amount": "979.99",
          "tax_amount": "49",
          "total_amount": "979.99",
          "name": "Canon EOS 50D Digital SLR Camera (body only)",
          "description": "Canon EOS 50D Digital SLR Camera (body only)",
          "image_url": "https://edge.disstg.commercecloud.salesforce.com/dw/image/v2/ZYBW_002/on/demandware.static/-/Sites-electronics-m-catalog/default/dwc16ea6c4/images/medium/canon-eos-50d-body.jpg",
          "fulfillment_mode": "ITEM_FULFILLMENT_MODEL_PHYSICAL"
        },
        {
          "id": {
            "value": "e0400168-958b-4a46-bf23-08cb6ee00630"
          },
          "external_id": "6f396ac44ded0ef59626a2a3f5",
          "external_product_id": "canon-powershot-a580M",
          "external_variant_id": "canon-powershot-a580M",
          "quantity": 1,
          "quantity_fulfilled": 1,
          "unit_price": "149.99",
          "discounted_unit_price": "149.99",
          "line_discount_amount": "0",
          "subtotal_amount": "149.99",
          "tax_amount": "7.5",
          "total_amount": "149.99",
          "name": "Canon PowerShot A580 Digital Point and Shoot Camera",
          "description": "Canon PowerShot A580 Digital Point and Shoot Camera",
          "image_url": "https://edge.disstg.commercecloud.salesforce.com/dw/image/v2/ZYBW_002/on/demandware.static/-/Sites-electronics-m-catalog/default/dwc1815b35/images/medium/canon-powershot-a580.jpg",
          "fulfillment_mode": "ITEM_FULFILLMENT_MODEL_PHYSICAL"
        }
      ],
      "shipment_plans": [
        {
          "id": {
            "value": "me"
          },
          "external_id": "me",
          "ship_to": {
            "first_name": "Solutions",
            "last_name": "Team",
            "email": "solutions@fast.co",
            "phone": "+18005551212",
            "address_1": "100 Park Avenue",
            "city_locality": "New York",
            "state_province_code": "NY",
            "country_code": "US",
            "postal_code": "10017"
          },
          "lines": [
            {
              "id": {
                "value": "2f914efb-0926-46af-86b4-6f7012d3d9bd"
              },
              "quantity": 1,
              "external_id": "dc8a000b11e0ac1bd81ed6427a"
            },
            {
              "id": {
                "value": "e0400168-958b-4a46-bf23-08cb6ee00630"
              },
              "quantity": 1,
              "external_id": "6f396ac44ded0ef59626a2a3f5"
            }
          ],
          "selected_option": {
            "external_id": "001",
            "name": "Ground",
            "shipment_type": "SHIPPING_OPTION_TYPE_OTHER",
            "cost": "15.19",
            "tax": "0.8",
            "total": "15.99"
          },
          "available_options": [
            {
              "external_id": "001",
              "name": "Ground",
              "shipment_type": "SHIPPING_OPTION_TYPE_OTHER",
              "cost": "15.99",
              "tax": "0",
              "total": "15.99",
              "service_level": "Order received within 7-10 business days"
            },
            {
              "external_id": "002",
              "name": "2-Day Express",
              "shipment_type": "SHIPPING_OPTION_TYPE_OTHER",
              "cost": "20.99",
              "tax": "0",
              "total": "20.99",
              "service_level": "Order received in 2 business days"
            },
            {
              "external_id": "003",
              "name": "Overnight",
              "shipment_type": "SHIPPING_OPTION_TYPE_OTHER",
              "cost": "29.99",
              "tax": "0",
              "total": "29.99",
              "service_level": "Order received the next business day"
            }
          ]
        }
      ],
      "total_amount": "1203.27",
      "sub_total": "1129.98",
      "total_discounts": "0",
      "total_tax": "57.3",
      "total_shipping": "15.99"
    }
  }
}
```
</p>
</details>

<details><summary><h3>Remove an Item from the Cart</h3></summary>
<p>

### Remove an Item from the Cart

If a shopper removes a line item from the cart within the Fast Checkout modal or decreases the quantity to 0, the entire Order object will need to be updated. The response should include changes to eligible shipping methods, coupons, etc. based on new cart contents. To remove a cart item, the update request is sent with the item id and a quantity of zero (the quantity attribute can be omitted entirely, as it's default value is zero).

**Request**
```json
{
  "app_id": "31d7ff3a-0128-440e-a5a2-c1e10d4c2d83",
  "type": "ENTITY_TYPE_ORDER",
  "order": {
    "order_id": {
      "value": "863e151e-703e-4da3-b044-a1c874afeda3"
    },
    "is_cart": true,
    "items": [
      {
        "item_id": {
          "value": "e0400168-958b-4a46-bf23-08cb6ee00630" 
          // default `quantity` attribute is 0
        },
        "external_product_id": "canon-powershot-a580M",
        "external_variant_id": "canon-powershot-a580M",
        "external_item_id": "6f396ac44ded0ef59626a2a3f5"
      }
    ],
    "external_id": "b097a63a4f829c6ecc192c3057"
  }
}
```

**Response**
```json
{
  "type": "ENTITY_TYPE_ORDER",
  "order": {
    "order": {
      "id": {
        "value": "863e151e-703e-4da3-b044-a1c874afeda3"
      },
      "external_id": "b097a63a4f829c6ecc192c3057",
      "order_type": "ORDER_TYPE_CART",
      "currency_code": "USD",
      "status": "ORDER_STATUS_CART",
      "bill_to": {
        "first_name": "Solutions",
        "last_name": "Team",
        "email": "solutions@fast.co",
        "phone": "+18005551212",
        "address_1": "100 Park Avenue",
        "city_locality": "New York",
        "state_province_code": "NY",
        "country_code": "US",
        "postal_code": "10017"
      },
      "lines": [
        {
          "id": {
            "value": "2f914efb-0926-46af-86b4-6f7012d3d9bd"
          },
          "external_id": "dc8a000b11e0ac1bd81ed6427a",
          "external_product_id": "canon-eos-50d-bodyM",
          "external_variant_id": "canon-eos-50d-bodyM",
          "quantity": 1,
          "quantity_fulfilled": 1,
          "unit_price": "979.99",
          "discounted_unit_price": "979.99",
          "line_discount_amount": "0",
          "subtotal_amount": "979.99",
          "tax_amount": "49",
          "total_amount": "979.99",
          "name": "Canon EOS 50D Digital SLR Camera (body only)",
          "description": "Canon EOS 50D Digital SLR Camera (body only)",
          "image_url": "https://edge.disstg.commercecloud.salesforce.com/dw/image/v2/ZYBW_002/on/demandware.static/-/Sites-electronics-m-catalog/default/dwc16ea6c4/images/medium/canon-eos-50d-body.jpg",
          "fulfillment_mode": "ITEM_FULFILLMENT_MODEL_PHYSICAL"
        }
      ],
      "shipment_plans": [
        {
          "id": {
            "value": "me"
          },
          "external_id": "me",
          "ship_to": {
            "first_name": "Solutions",
            "last_name": "Team",
            "email": "solutions@fast.co",
            "phone": "+18005551212",
            "address_1": "100 Park Avenue",
            "city_locality": "New York",
            "state_province_code": "NY",
            "country_code": "US",
            "postal_code": "10017"
          },
          "lines": [
            {
              "id": {
                "value": "2f914efb-0926-46af-86b4-6f7012d3d9bd"
              },
              "quantity": 1,
              "external_id": "dc8a000b11e0ac1bd81ed6427a"
            }
          ],
          "selected_option": {
            "external_id": "001",
            "name": "Ground",
            "shipment_type": "SHIPPING_OPTION_TYPE_OTHER",
            "cost": "15.19",
            "tax": "0.8",
            "total": "15.99"
          },
          "available_options": [
            {
              "external_id": "001",
              "name": "Ground",
              "shipment_type": "SHIPPING_OPTION_TYPE_OTHER",
              "cost": "15.99",
              "tax": "0",
              "total": "15.99",
              "service_level": "Order received within 7-10 business days"
            },
            {
              "external_id": "002",
              "name": "2-Day Express",
              "shipment_type": "SHIPPING_OPTION_TYPE_OTHER",
              "cost": "20.99",
              "tax": "0",
              "total": "20.99",
              "service_level": "Order received in 2 business days"
            },
            {
              "external_id": "003",
              "name": "Overnight",
              "shipment_type": "SHIPPING_OPTION_TYPE_OTHER",
              "cost": "29.99",
              "tax": "0",
              "total": "29.99",
              "service_level": "Order received the next business day"
            }
          ]
        }
      ],
      "total_amount": "1045.78",
      "sub_total": "979.99",
      "total_discounts": "0",
      "total_tax": "49.8",
      "total_shipping": "15.99"
    }
  }
}
```
</p>
</details>

<details><summary><h3>Update shipping address associated with an order</h3></summary>
<p>

### Update a Shipping Address Associated with an Order

If a shopper updates their shipping address on the Fast order modal, the Order object is updated.

**Request**
```json
{
  "app_id": "088fdade-8809-471c-89c2-f429fa844af2",
  "type": "ENTITY_TYPE_ORDER",
  "order": {
    "order_id": {
      "value": "d922708c-0e46-4bbf-a435-d479dd7a63b6"
    },
    "is_cart": true,
    "shipments": [
      {
        "plan_id": {
          "value": "OnzoaAyj1Wn8Ej-um5W8JfJLnqk="
        },
        "ship_to": {
          "first_name": "Solutions",
          "last_name": "Team",
          "email": "solutions@fast.co",
          "address_1": "10 Southampton Street",
          "city_locality": "London",
          "state_province_code": "England",
          "country": "GB",
          "country_code": "GB",
          "postal_code": "WC2E 7HA"
        },
        "line_refs": [
          {
            "id": {
              "value": "e3b7f30c-dd08-4a4a-9546-835754eac41d"
            },
            "quantity": 1
          }
        ]
      }
    ],
    "external_id": "c8XyP8tIPIOluGmOgOv1D6bABUScTyvh"
  }
}
```

**Response**
```json
{
  "type": "ENTITY_TYPE_ORDER",
  "order": {
    "order": {
      "id": {
        "value": "d922708c-0e46-4bbf-a435-d479dd7a63b6"
      },
      "external_id": "c8XyP8tIPIOluGmOgOv1D6bABUScTyvh",
      "order_type": "ORDER_TYPE_CART",
      "currency_code": "USD",
      "status": "ORDER_STATUS_CART",
      "bill_to": {
        "first_name": "Solutions",
        "last_name": "Team",
        "email": "solutions@fast.co",
        "phone": "+18005551212",
        "address_1": "100 Park Avenue",
        "city_locality": "New York",
        "state_province": "New York",
        "state_province_code": "NY",
        "country": "US",
        "postal_code": "10017"
      },
      "lines": [
        {
          "id": {
            "value": "e3b7f30c-dd08-4a4a-9546-835754eac41d"
          },
          "external_id": "6434",
          "external_product_id": "419",
          "quantity": 1,
          "unit_price": "45",
          "discounted_unit_price": "45",
          "line_discount_amount": "0",
          "subtotal_amount": "45",
          "total_amount": "45",
          "name": "Proteus Fitness Jackshirt",
          "image_url": "",
          "fulfillment_mode": "ITEM_FULFILLMENT_MODEL_PHYSICAL"
        }
      ],
      "shipment_plans": [
        {
          "id": {
            "value": "OnzoaAyj1Wn8Ej-um5W8JfJLnqk="
          },
          "ship_to": {
            "first_name": "Solutions",
            "last_name": "Team",
            "email": "solutions@fast.co",
            "phone": "555-555-5555",
            "address_1": "10 Southampton Street",
            "city_locality": "London",
            "state_province": "New York",
            "country": "GB",
            "postal_code": "WC2E 7HA"
          },
          "lines": [
            {
              "id": {
                "value": "e3b7f30c-dd08-4a4a-9546-835754eac41d"
              },
              "quantity": 1,
              "external_id": "6434"
            }
          ],
          "selected_option": {
            "external_id": "flatrate_flatrate",
            "name": "Fixed",
            "cost": "5",
            "tax": "0",
            "total": "5",
            "service_level": "Flat Rate Fixed"
          },
          "available_options": [
            {
              "external_id": "flatrate_flatrate",
              "name": "Fixed",
              "cost": "5",
              "tax": "0",
              "total": "5",
              "service_level": "Flat Rate Fixed"
            }
          ]
        }
      ],
      "total_amount": "50",
      "sub_total": "45",
      "total_shipping": "5"
    }
  }
}
```
</p>
</details>

<details><summary><h3>Update Billing Address Associated with an Order</h3></summary>
<p>

### Update Billing Address Associated with an Order

If a shopper updates the billing address associated with a cart, the Order object will need to be updated.

**Request**
```json
{
  "app_id": "088fdade-8809-471c-89c2-f429fa844af2",
  "type": "ENTITY_TYPE_ORDER",
  "order": {
    "order_id": {
      "value": "14973858-264a-4126-b3f0-4191e00a462f"
    },
    "is_cart": true,
    "bill_to": {
      "first_name": "Solutions",
      "last_name": "Team",
      "email": "solutions@fast.co",
      "phone": "+18005551212",
      "address_1": "100 Park Avenue",
      "city_locality": "New York",
      "state_province_code": "NY",
      "country": "US",
      "country_code": "US",
      "postal_code": "10017"
    },
    "external_id": "CKAPYRemQ7eEV9PewUZeQX2ZnAQIG0Za"
  }
}
```

**Response**
```json
{
  "type": "ENTITY_TYPE_ORDER",
  "order": {
    "order": {
      "id": {
        "value": "14973858-264a-4126-b3f0-4191e00a462f"
      },
      "external_id": "CKAPYRemQ7eEV9PewUZeQX2ZnAQIG0Za",
      "order_type": "ORDER_TYPE_CART",
      "currency_code": "USD",
      "status": "ORDER_STATUS_CART",
      "bill_to": {
        "first_name": "Solutions",
        "last_name": "Team",
        "email": "solutions@fast.co",
        "phone": "+18005551212",
        "address_1": "100 Park Avenue",
        "city_locality": "New York",
        "state_province": "New York",
        "state_province_code": "NY",
        "country": "US",
        "postal_code": "10017"
      },
      "lines": [
        {
          "id": {
            "value": "fc8cc4ab-aba9-4539-bbb0-59b0a0a5e872"
          },
          "external_id": "6432",
          "external_product_id": "690",
          "quantity": 1,
          "unit_price": "22",
          "discounted_unit_price": "22",
          "line_discount_amount": "0",
          "subtotal_amount": "22",
          "total_amount": "22",
          "name": "Argus All-Weather Tank",
          "image_url": "",
          "fulfillment_mode": "ITEM_FULFILLMENT_MODEL_PHYSICAL"
        }
      ],
      "total_amount": "22",
      "sub_total": "22"
    }
  }
}
```
</p>
</details>

<details><summary><h3>Update Shipping Option Associated with an Order</h3></summary>
<p>

### Update Shipping Option Associated with an Order

If a shopper updates the shipping option (i.e. ground, next day, etc), the Order object will need to be updated.

**Request**
```json
{
  "app_id": "088fdade-8809-471c-89c2-f429fa844af2",
  "type": "ENTITY_TYPE_ORDER",
  "order": {
    "order_id": {
      "value": "d922708c-0e46-4bbf-a435-d479dd7a63b6"
    },
    "is_cart": true,
    "shipping_option": {
      "plan_id": {
        "value": "FGRqQlj4HVs-OSN1mCRLGAec7K8="
      },
      "option_id": {
        "value": "flatrate_flatrate"
      },
      "external_option_id": "flatrate_flatrate"
    },
    "external_id": "c8XyP8tIPIOluGmOgOv1D6bABUScTyvh"
  }
}
```

**Response**
```json
{
  "type": "ENTITY_TYPE_ORDER",
  "order": {
    "order": {
      "id": {
        "value": "d922708c-0e46-4bbf-a435-d479dd7a63b6"
      },
      "external_id": "c8XyP8tIPIOluGmOgOv1D6bABUScTyvh",
      "order_type": "ORDER_TYPE_CART",
      "currency_code": "USD",
      "status": "ORDER_STATUS_CART",
      "bill_to": {
        "first_name": "Solutions",
        "last_name": "Team",
        "email": "solutions@fast.co",
        "phone": "+18005551212",
        "address_1": "100 Park Avenue",
        "city_locality": "New York",
        "state_province": "New York",
        "state_province_code": "NY",
        "country": "US",
        "postal_code": "10017"
      },
      "lines": [
        {
          "id": {
            "value": "e3b7f30c-dd08-4a4a-9546-835754eac41d"
          },
          "external_id": "6434",
          "external_product_id": "419",
          "quantity": 1,
          "unit_price": "45",
          "discounted_unit_price": "45",
          "line_discount_amount": "0",
          "subtotal_amount": "45",
          "total_amount": "45",
          "name": "Proteus Fitness Jackshirt",
          "image_url": "",
          "fulfillment_mode": "ITEM_FULFILLMENT_MODEL_PHYSICAL"
        }
      ],
      "shipment_plans": [
        {
          "ship_to": {
            "first_name": "Solutions",
            "last_name": "Team",
            "email": "solutions@fast.co",
            "phone": "555-555-5555",
            "address_1": "10 Southampton Street",
            "city_locality": "London",
            "state_province": "New York",
            "country": "GB",
            "postal_code": "WC2E 7HA"
          },
          "lines": [
            {
              "id": {
                "value": "e3b7f30c-dd08-4a4a-9546-835754eac41d"
              },
              "quantity": 1,
              "external_id": "6434"
            }
          ],
          "selected_option": {
            "external_id": "flatrate_flatrate",
            "name": "Fixed",
            "cost": "5",
            "tax": "0",
            "total": "5",
            "service_level": "Flat Rate Fixed"
          },
          "available_options": [
            {
              "external_id": "flatrate_flatrate",
              "name": "Fixed",
              "cost": "5",
              "tax": "0",
              "total": "5",
              "service_level": "Flat Rate Fixed"
            }
          ]
        }
      ],
      "total_amount": "50",
      "sub_total": "45",
      "total_shipping": "5"
    }
  }
}
```
</p>
</details>

<details><summary><h3>Update Item Quantity</h3></summary>
<p>

### Update Item Quantity

If shoppers “Return to Store” to change the quantity of items (add/remove) in their Fast checkout session,  the entire Order object will need to be updated. This needs to check if inventory is available. The response should include changes to eligible shipping methods, coupons, etc. based on the new cart contents.

**Request**
```json
{
  "app_id": "31d7ff3a-0128-440e-a5a2-c1e10d4c2d83",
  "type": "ENTITY_TYPE_ORDER",
  "order": {
    "order_id": {
      "value": "7009c125-a487-4fd8-8d0c-2aad0c7e8f37"
    },
    "is_cart": true,
    "items": [
      {
        "item_id": {
          "value": "619eb41a-9174-486c-80e1-f9fcd0a33030"
        },
        "quantity": 5,
        "external_product_id": "73910532M",
        "external_variant_id": "883858858265M",
        "external_item_id": "5134a3aadd6d1f1b87172ad195"
      }
    ],
    "external_id": "ffcf4af7d4b5bc208bca719bed"
  }
}
```

**Response**
```json
{
  "type": "ENTITY_TYPE_ORDER",
  "order": {
    "order": {
      "id": {
        "value": "7009c125-a487-4fd8-8d0c-2aad0c7e8f37"
      },
      "external_id": "ffcf4af7d4b5bc208bca719bed",
      "order_type": "ORDER_TYPE_CART",
      "currency_code": "USD",
      "status": "ORDER_STATUS_CART",
      "bill_to": {
        "first_name": "Solutions",
        "last_name": "Team",
        "email": "solutions@fast.co",
        "phone": "+18005551212",
        "address_1": "100 Park Avenue",
        "city_locality": "New York",
        "state_province_code": "NY",
        "country_code": "US",
        "postal_code": "10017"
      },
      "lines": [
        {
          "id": {
            "value": "619eb41a-9174-486c-80e1-f9fcd0a33030"
          },
          "external_id": "5134a3aadd6d1f1b87172ad195",
          "external_product_id": "73910532M",
          "external_variant_id": "883858858265M",
          "quantity": 5,
          "quantity_fulfilled": 5,
          "unit_price": "195",
          "discounted_unit_price": "195",
          "line_discount_amount": "0",
          "subtotal_amount": "975",
          "tax_amount": "48.75",
          "total_amount": "975",
          "name": "Basic Leg Trousers",
          "description": "Basic Leg Trousers",
          "image_url": "https://edge.disstg.commercecloud.salesforce.com/dw/image/v2/ZYBW_002/on/demandware.static/-/Sites-apparel-m-catalog/default/dw64bef723/images/medium/90011212_001_0.jpg",
          "fulfillment_mode": "ITEM_FULFILLMENT_MODEL_PHYSICAL"
        }
      ],
      "shipment_plans": [
        {
          "id": {
            "value": "me"
          },
          "external_id": "me",
          "ship_to": {
            "first_name": "Solutions",
            "last_name": "Team",
            "email": "solutions@fast.co",
            "phone": "+18005551212",
            "address_1": "100 Park Avenue",
            "city_locality": "New York",
            "state_province_code": "NY",
            "country_code": "US",
            "postal_code": "10017"
          },
          "lines": [
            {
              "id": {
                "value": "619eb41a-9174-486c-80e1-f9fcd0a33030"
              },
              "quantity": 5,
              "external_id": "5134a3aadd6d1f1b87172ad195"
            }
          ],
          "selected_option": {
            "external_id": "001",
            "name": "Ground",
            "shipment_type": "SHIPPING_OPTION_TYPE_OTHER",
            "cost": "15.19",
            "tax": "0.8",
            "total": "15.99"
          },
          "available_options": [
            {
              "external_id": "001",
              "name": "Ground",
              "shipment_type": "SHIPPING_OPTION_TYPE_OTHER",
              "cost": "15.99",
              "tax": "0",
              "total": "15.99",
              "service_level": "Order received within 7-10 business days"
            },
            {
              "external_id": "002",
              "name": "2-Day Express",
              "shipment_type": "SHIPPING_OPTION_TYPE_OTHER",
              "cost": "20.99",
              "tax": "0",
              "total": "20.99",
              "service_level": "Order received in 2 business days"
            },
            {
              "external_id": "003",
              "name": "Overnight",
              "shipment_type": "SHIPPING_OPTION_TYPE_OTHER",
              "cost": "29.99",
              "tax": "0",
              "total": "29.99",
              "service_level": "Order received the next business day"
            }
          ]
        }
      ],
      "total_amount": "1040.54",
      "sub_total": "975",
      "total_discounts": "0",
      "total_tax": "49.55",
      "total_shipping": "15.99"
    }
  }
}
```
</p>
</details>

<details><summary><h3>Add a Coupon to the Cart</h3></summary>
<p>

### Add a Coupon to the Cart

If a shopper adds a coupon to the cart, the Order object will need to be returned in full including the coupon attribute.

**Request**
```json
{
  "app_id": "31d7ff3a-0128-440e-a5a2-c1e10d4c2d83",
  "type": "ENTITY_TYPE_ORDER",
  "order": {
    "order_id": {
      "value": "b17848cc-8e39-4514-8490-e6f30f03fafd"
    },
    "is_cart": true,
    "coupon": {
      "code": "orderLevel"
    },
    "external_id": "8ff441c3a891743ec60b183207"
  }
}
```

**Response**
```json
{
  "type": "ENTITY_TYPE_ORDER",
  "order": {
    "order": {
      "id": {
        "value": "b17848cc-8e39-4514-8490-e6f30f03fafd"
      },
      "external_id": "8ff441c3a891743ec60b183207",
      "order_type": "ORDER_TYPE_CART",
      "currency_code": "USD",
      "status": "ORDER_STATUS_CART",
      "bill_to": {
        "first_name": "Solutions",
        "last_name": "Team",
        "email": "solutions@fast.co",
        "phone": "+18005551212",
        "address_1": "100 Park Avenue",
        "city_locality": "New York",
        "state_province_code": "NY",
        "country_code": "US",
        "postal_code": "10017"
      },
      "lines": [
        {
          "id": {
            "value": "078a22fa-4815-4afe-a95e-28108e1cd0de"
          },
          "external_id": "fc84506f4e3fdb2c5f18781584",
          "external_product_id": "73910532M",
          "external_variant_id": "883360352336M",
          "quantity": 6,
          "quantity_fulfilled": 6,
          "unit_price": "195",
          "discounted_unit_price": "195",
          "line_discount_amount": "585",
          "subtotal_amount": "1170",
          "tax_amount": "58.5",
          "total_amount": "1170",
          "name": "Basic Leg Trousers",
          "description": "Basic Leg Trousers",
          "image_url": "https://edge.disstg.commercecloud.salesforce.com/dw/image/v2/ZYBW_002/on/demandware.static/-/Sites-apparel-m-catalog/default/dw9daaeb69/images/medium/90011212_A00_0.jpg",
          "fulfillment_mode": "ITEM_FULFILLMENT_MODEL_PHYSICAL"
        }
      ],
      "shipment_plans": [
        {
          "id": {
            "value": "me"
          },
          "external_id": "me",
          "ship_to": {
            "first_name": "Solutions",
            "last_name": "Team",
            "email": "solutions@fast.co",
            "phone": "+18005551212",
            "address_1": "100 Park Avenue",
            "city_locality": "New York",
            "state_province_code": "NY",
            "country_code": "US",
            "postal_code": "10017"
          },
          "lines": [
            {
              "id": {
                "value": "078a22fa-4815-4afe-a95e-28108e1cd0de"
              },
              "quantity": 6,
              "external_id": "fc84506f4e3fdb2c5f18781584"
            }
          ],
          "selected_option": {
            "external_id": "001",
            "name": "Ground",
            "shipment_type": "SHIPPING_OPTION_TYPE_OTHER",
            "cost": "15.19",
            "tax": "0.8",
            "total": "15.99"
          },
          "available_options": [
            {
              "external_id": "001",
              "name": "Ground",
              "shipment_type": "SHIPPING_OPTION_TYPE_OTHER",
              "cost": "15.99",
              "tax": "0",
              "total": "15.99",
              "service_level": "Order received within 7-10 business days"
            },
            {
              "external_id": "002",
              "name": "2-Day Express",
              "shipment_type": "SHIPPING_OPTION_TYPE_OTHER",
              "cost": "20.99",
              "tax": "0",
              "total": "20.99",
              "service_level": "Order received in 2 business days"
            },
            {
              "external_id": "003",
              "name": "Overnight",
              "shipment_type": "SHIPPING_OPTION_TYPE_OTHER",
              "cost": "29.99",
              "tax": "0",
              "total": "29.99",
              "service_level": "Order received the next business day"
            }
          ]
        }
      ],
      "coupons": [
        {
          "code": "orderLevel",
          "description": "a8e76739d5fdd760827b0c3015 - Order Level Coupon Test - https://zybw-002.sandbox.us01.dx.commercecloud.salesforce.com/s/RefArch/dw/shop/v21_9/promotions/ref-arch-order-coupon-promotion-1",
          "origin": "DISCOUNT_ORIGIN_USER",
          "type": "DISCOUNT_TYPE_REGULAR",
          "applied": true,
          "total_amount": "585"
        }
      ],
      "total_amount": "631.04",
      "sub_total": "1170",
      "total_discounts": "585",
      "total_tax": "30.05",
      "total_shipping": "15.99"
    }
  }
}
```
</p>
</details>

<details><summary><h3>Remove a Coupon from the Cart</h3></summary>
<p>

### Remove a Coupon from the Cart

If a shopper removes a coupon, the coupon will need to be removed from the coupon attribute in the Order object, and the accurate total reflected.

**Request**
```json
{
  "app_id": "31d7ff3a-0128-440e-a5a2-c1e10d4c2d83",
  "type": "ENTITY_TYPE_ORDER",
  "order": {
    "order_id": {
      "value": "b17848cc-8e39-4514-8490-e6f30f03fafd"
    },
    "is_cart": true,
    "coupon": {
      "code": "orderLevel",
      "remove": true
    },
    "external_id": "8ff441c3a891743ec60b183207"
  }
}
```

**Response**
```json
{
  "type": "ENTITY_TYPE_ORDER",
  "order": {
    "order": {
      "id": {
        "value": "b17848cc-8e39-4514-8490-e6f30f03fafd"
      },
      "external_id": "8ff441c3a891743ec60b183207",
      "order_type": "ORDER_TYPE_CART",
      "currency_code": "USD",
      "status": "ORDER_STATUS_CART",
      "bill_to": {
        "first_name": "Solutions",
        "last_name": "Team",
        "email": "solutions@fast.co",
        "phone": "+18005551212",
        "address_1": "100 Park Avenue",
        "city_locality": "New York",
        "state_province_code": "NY",
        "country_code": "US",
        "postal_code": "10017"
      },
      "lines": [
        {
          "id": {
            "value": "078a22fa-4815-4afe-a95e-28108e1cd0de"
          },
          "external_id": "fc84506f4e3fdb2c5f18781584",
          "external_product_id": "73910532M",
          "external_variant_id": "883360352336M",
          "quantity": 6,
          "quantity_fulfilled": 6,
          "unit_price": "195",
          "discounted_unit_price": "195",
          "line_discount_amount": "0",
          "subtotal_amount": "1170",
          "tax_amount": "58.5",
          "total_amount": "1170",
          "name": "Basic Leg Trousers",
          "description": "Basic Leg Trousers",
          "image_url": "https://edge.disstg.commercecloud.salesforce.com/dw/image/v2/ZYBW_002/on/demandware.static/-/Sites-apparel-m-catalog/default/dw9daaeb69/images/medium/90011212_A00_0.jpg",
          "fulfillment_mode": "ITEM_FULFILLMENT_MODEL_PHYSICAL"
        }
      ],
      "shipment_plans": [
        {
          "id": {
            "value": "me"
          },
          "external_id": "me",
          "ship_to": {
            "first_name": "Solutions",
            "last_name": "Team",
            "email": "solutions@fast.co",
            "phone": "+18005551212",
            "address_1": "100 Park Avenue",
            "city_locality": "New York",
            "state_province_code": "NY",
            "country_code": "US",
            "postal_code": "10017"
          },
          "lines": [
            {
              "id": {
                "value": "078a22fa-4815-4afe-a95e-28108e1cd0de"
              },
              "quantity": 6,
              "external_id": "fc84506f4e3fdb2c5f18781584"
            }
          ],
          "selected_option": {
            "external_id": "001",
            "name": "Ground",
            "shipment_type": "SHIPPING_OPTION_TYPE_OTHER",
            "cost": "15.19",
            "tax": "0.8",
            "total": "15.99"
          },
          "available_options": [
            {
              "external_id": "001",
              "name": "Ground",
              "shipment_type": "SHIPPING_OPTION_TYPE_OTHER",
              "cost": "15.99",
              "tax": "0",
              "total": "15.99",
              "service_level": "Order received within 7-10 business days"
            },
            {
              "external_id": "002",
              "name": "2-Day Express",
              "shipment_type": "SHIPPING_OPTION_TYPE_OTHER",
              "cost": "20.99",
              "tax": "0",
              "total": "20.99",
              "service_level": "Order received in 2 business days"
            },
            {
              "external_id": "003",
              "name": "Overnight",
              "shipment_type": "SHIPPING_OPTION_TYPE_OTHER",
              "cost": "29.99",
              "tax": "0",
              "total": "29.99",
              "service_level": "Order received the next business day"
            }
          ]
        }
      ],
      "total_amount": "1245.29",
      "sub_total": "1170",
      "total_discounts": "0",
      "total_tax": "59.3",
      "total_shipping": "15.99"
    }
  }
}
```
</p>
</details>

<details><summary><h3>Convert a Cart to an Order</h3></summary>
<p>

### Convert a Cart to an Order

Once the checkout timer expires, you will receive an update request to convert the Order object from cart status to order status to reserve inventory (should not be exportable).

**Request**
```json
{
  "app_id": "31d7ff3a-0128-440e-a5a2-c1e10d4c2d83",
  "type": "ENTITY_TYPE_ORDER",
  "order": {
    "is_cart": true,
    "convert_mode": "CART_TO_ORDER_CONVERT_UPDATE_AND_CONVERT",
    "convert_cart_to_order": true,
    "external_id": "9a7d809060065e7239daecc0d5",
    "device_info": {
      "ip_address": "24.168.83.213"
    },
    "payment": {
      "token": "d5afb4a7-9510-4fc2-8f3e-d94e184659ed",
      "expire_on": "1646063411"
    }
  }
}
```

**Response**
```json
{
  "type": "ENTITY_TYPE_ORDER",
  "order": {
    "order": {
      "id": {
        "value": "d5afb4a7-9510-4fc2-8f3e-d94e184659ed"
      },
      "external_id": "00000401",
      "user_id": "bdRiXVbTfwxYEusFJYQmYcxPaL",
      "order_type": "ORDER_TYPE_ORDER",
      "currency_code": "USD",
      "status": "ORDER_STATUS_CART",
      "bill_to": {
        "first_name": "Solutions",
        "last_name": "Team",
        "email": "solutions@fast.co",
        "phone": "+18005551212",
        "address_1": "100 Park Avenue",
        "city_locality": "New York",
        "state_province_code": "NY",
        "country_code": "US",
        "postal_code": "10017"
      },
      "lines": [
        {
          "id": {
            "value": "6adb8659-8c65-4376-84be-d8d0bce9e82b"
          },
          "external_id": "1526cc76cee6079c04d3074206",
          "external_product_id": "883360525433M",
          "external_variant_id": "883360525433M",
          "quantity": 1,
          "quantity_fulfilled": 1,
          "unit_price": "175",
          "discounted_unit_price": "0",
          "line_discount_amount": "0",
          "subtotal_amount": "175",
          "tax_amount": "8.75",
          "total_amount": "175",
          "name": "Slim Fit Pants",
          "description": "Slim Fit Pants",
          "image_url": "https://edge.disstg.commercecloud.salesforce.com/dw/image/v2/ZYBW_002/on/demandware.static/-/Sites-apparel-m-catalog/default/dwb9691140/images/medium/B0374208_B7H_0.jpg",
          "fulfillment_mode": "ITEM_FULFILLMENT_MODEL_PHYSICAL"
        }
      ],
      "shipment_plans": [
        {
          "id": {
            "value": "me"
          },
          "external_id": "me",
          "ship_to": {
            "first_name": "Solutions",
            "last_name": "Team",
            "email": "solutions@fast.co",
            "phone": "+18005551212",
            "address_1": "100 Park Avenue",
            "city_locality": "New York",
            "state_province_code": "NY",
            "country_code": "US",
            "postal_code": "10017"
          },
          "lines": [
            {
              "id": {
                "value": "6adb8659-8c65-4376-84be-d8d0bce9e82b"
              },
              "quantity": 1,
              "external_id": "1526cc76cee6079c04d3074206"
            }
          ],
          "selected_option": {
            "external_id": "001",
            "name": "Ground",
            "shipment_type": "SHIPPING_OPTION_TYPE_OTHER",
            "cost": "7.59",
            "tax": "0.4",
            "total": "7.99"
          }
        }
      ],
      "total_amount": "192.14",
      "sub_total": "175",
      "total_discounts": "0",
      "total_tax": "9.15",
      "total_shipping": "7.99"
    }
  }
}
```

</p>
</details>

<details><summary><h3>Update Order Status</h3></summary>
<p>

### Update Order Status

An order status can be updated to [one of the listed order statues](../../../../resources/order-statuses).

After a cart has been converted to an order, the following status updates will occur:

#### Payment authorization

Once payment has been successfully authorized, you will receive an update request to `ORDER_STATUS_BOOKED`. 

**Request**
```json
{
  "app_id": "31d7ff3a-0128-440e-a5a2-c1e10d4c2d83",
  "type": "ENTITY_TYPE_ORDER",
  "order": {
    "convert_cart_to_order": true,
    "status": "ORDER_STATUS_BOOKED",
    "external_id": "00000401"
  }
}
```

**Response**
```json
{
  "type": "ENTITY_TYPE_ORDER",
  "order": {
    "order": {
      "id": {
        "value": "d5afb4a7-9510-4fc2-8f3e-d94e184659ed"
      },
      "external_id": "00000401",
      "user_id": "bdRiXVbTfwxYEusFJYQmYcxPaL",
      "order_type": "ORDER_TYPE_ORDER",
      "currency_code": "USD",
      "status": "ORDER_STATUS_BOOKED",
      "bill_to": {
        "first_name": "Solutions",
        "last_name": "Team",
        "email": "solutions@fast.co",
        "phone": "+18005551212",
        "address_1": "100 Park Avenue",
        "city_locality": "New York",
        "state_province_code": "NY",
        "country_code": "US",
        "postal_code": "10017"
      },
      "lines": [
        {
          "id": {
            "value": "6adb8659-8c65-4376-84be-d8d0bce9e82b"
          },
          "external_id": "1526cc76cee6079c04d3074206",
          "external_product_id": "91736743M",
          "external_variant_id": "883360525433M",
          "quantity": 1,
          "quantity_fulfilled": 1,
          "unit_price": "175",
          "discounted_unit_price": "175",
          "line_discount_amount": "0",
          "subtotal_amount": "175",
          "tax_amount": "8.75",
          "total_amount": "175",
          "name": "Slim Fit Pants",
          "description": "Slim Fit Pants",
          "image_url": "https://edge.disstg.commercecloud.salesforce.com/dw/image/v2/ZYBW_002/on/demandware.static/-/Sites-apparel-m-catalog/default/dwb9691140/images/medium/B0374208_B7H_0.jpg",
          "fulfillment_mode": "ITEM_FULFILLMENT_MODEL_PHYSICAL"
        }
      ],
      "shipment_plans": [
        {
          "id": {
            "value": "me"
          },
          "external_id": "me",
          "ship_to": {
            "first_name": "Solutions",
            "last_name": "Team",
            "email": "solutions@fast.co",
            "phone": "+18005551212",
            "address_1": "100 Park Avenue",
            "city_locality": "New York",
            "state_province_code": "NY",
            "country_code": "US",
            "postal_code": "10017"
          },
          "lines": [
            {
              "id": {
                "value": "6adb8659-8c65-4376-84be-d8d0bce9e82b"
              },
              "quantity": 1,
              "external_id": "1526cc76cee6079c04d3074206"
            }
          ],
          "selected_option": {
            "external_id": "001",
            "name": "Ground",
            "shipment_type": "SHIPPING_OPTION_TYPE_OTHER",
            "cost": "7.59",
            "tax": "0.4",
            "total": "7.99"
          }
        }
      ],
      "total_amount": "192.14",
      "sub_total": "175",
      "total_discounts": "0",
      "total_tax": "9.15",
      "total_shipping": "7.99"
    }
  }
}
```
#### Fraud Approved (Safe to export)

Once the fraud check has passed successfully, you will receive an update request to `ORDER_STATUS_PENDING_FULFILLMENT`.

**Request**
```json
{
  "app_id": "31d7ff3a-0128-440e-a5a2-c1e10d4c2d83",
  "type": "ENTITY_TYPE_ORDER",
  "order": {
    "convert_cart_to_order": true,
    "status": "ORDER_STATUS_PENDING_FULFILLMENT",
    "external_id": "00000401"
  }
}
```

**Response**
```json
{
  "type": "ENTITY_TYPE_ORDER",
  "order": {
    "order": {
      "id": {
        "value": "d5afb4a7-9510-4fc2-8f3e-d94e184659ed"
      },
      "external_id": "00000401",
      "user_id": "bdRiXVbTfwxYEusFJYQmYcxPaL",
      "order_type": "ORDER_TYPE_ORDER",
      "currency_code": "USD",
      "status": "ORDER_STATUS_PENDING_FULFILLMENT",
      "bill_to": {
        "first_name": "Solutions",
        "last_name": "Team",
        "email": "solutions@fast.co",
        "phone": "+18005551212",
        "address_1": "100 Park Avenue",
        "city_locality": "New York",
        "state_province_code": "NY",
        "country_code": "US",
        "postal_code": "10017"
      },
      "lines": [
        {
          "id": {
            "value": "6adb8659-8c65-4376-84be-d8d0bce9e82b"
          },
          "external_id": "1526cc76cee6079c04d3074206",
          "external_product_id": "91736743M",
          "external_variant_id": "883360525433M",
          "quantity": 1,
          "quantity_fulfilled": 1,
          "unit_price": "175",
          "discounted_unit_price": "175",
          "line_discount_amount": "0",
          "subtotal_amount": "175",
          "tax_amount": "8.75",
          "total_amount": "175",
          "name": "Slim Fit Pants",
          "description": "Slim Fit Pants",
          "image_url": "https://edge.disstg.commercecloud.salesforce.com/dw/image/v2/ZYBW_002/on/demandware.static/-/Sites-apparel-m-catalog/default/dwb9691140/images/medium/B0374208_B7H_0.jpg",
          "fulfillment_mode": "ITEM_FULFILLMENT_MODEL_PHYSICAL"
        }
      ],
      "shipment_plans": [
        {
          "id": {
            "value": "me"
          },
          "external_id": "me",
          "ship_to": {
            "first_name": "Solutions",
            "last_name": "Team",
            "email": "solutions@fast.co",
            "phone": "+18005551212",
            "address_1": "100 Park Avenue",
            "city_locality": "New York",
            "state_province_code": "NY",
            "country_code": "US",
            "postal_code": "10017"
          },
          "lines": [
            {
              "id": {
                "value": "6adb8659-8c65-4376-84be-d8d0bce9e82b"
              },
              "quantity": 1,
              "external_id": "1526cc76cee6079c04d3074206"
            }
          ],
          "selected_option": {
            "external_id": "001",
            "name": "Ground",
            "shipment_type": "SHIPPING_OPTION_TYPE_OTHER",
            "cost": "7.59",
            "tax": "0.4",
            "total": "7.99"
          }
        }
      ],
      "total_amount": "192.14",
      "sub_total": "175",
      "total_discounts": "0",
      "total_tax": "9.15",
      "total_shipping": "7.99"
    }
  }
}
```

#### Auth/Fraud Rejection

If there is a failure in either payment authorization or fraud check, you will receive an update request to `ORDER_STATUS_CANCELED`. If this occurs after Booked status, it can be assumed to be for fraud reasons.

**Request**
```json
{
  "app_id": "31d7ff3a-0128-440e-a5a2-c1e10d4c2d83",
  "type": "ENTITY_TYPE_ORDER",
  "order": {
    "convert_cart_to_order": true,
    "status": "ORDER_STATUS_CANCELED",
    "external_id": "00000402"
  }
}
```

**Response**
```json
{
  "type": "ENTITY_TYPE_ORDER",
  "order": {
    "order": {
      "id": {
        "value": "9dcb228f-b98c-468c-866d-1feecec70e6f"
      },
      "external_id": "00000402",
      "user_id": "abT7T7S8HxTRxB1JVf9zndB1k4",
      "order_type": "ORDER_TYPE_ORDER",
      "currency_code": "USD",
      "status": "ORDER_STATUS_CANCELED",
      "bill_to": {
        "first_name": "Solutions",
        "last_name": "Team",
        "email": "solutions@fast.co",
        "phone": "+18005551212",
        "address_1": "100 Park Avenue",
        "city_locality": "New York",
        "state_province_code": "NY",
        "country_code": "US",
        "postal_code": "10017"
      },
      "lines": [
        {
          "id": {
            "value": "9734f22a-1720-47c3-9201-75d260f6835f"
          },
          "external_id": "0090abe9faf6d2e919ed5927f0",
          "external_product_id": "91736743M",
          "external_variant_id": "883360525433M",
          "quantity": 1,
          "quantity_fulfilled": 1,
          "unit_price": "175",
          "discounted_unit_price": "175",
          "line_discount_amount": "0",
          "subtotal_amount": "175",
          "tax_amount": "8.75",
          "total_amount": "175",
          "name": "Slim Fit Pants",
          "description": "Slim Fit Pants",
          "image_url": "https://edge.disstg.commercecloud.salesforce.com/dw/image/v2/ZYBW_002/on/demandware.static/-/Sites-apparel-m-catalog/default/dwb9691140/images/medium/B0374208_B7H_0.jpg",
          "fulfillment_mode": "ITEM_FULFILLMENT_MODEL_PHYSICAL"
        }
      ],
      "shipment_plans": [
        {
          "id": {
            "value": "me"
          },
          "external_id": "me",
          "ship_to": {
            "first_name": "Solutions",
            "last_name": "Team",
            "email": "solutions@fast.co",
            "phone": "+18005551212",
            "address_1": "100 Park Avenue",
            "city_locality": "New York",
            "state_province_code": "NY",
            "country_code": "US",
            "postal_code": "10017"
          },
          "lines": [
            {
              "id": {
                "value": "9734f22a-1720-47c3-9201-75d260f6835f"
              },
              "quantity": 1,
              "external_id": "0090abe9faf6d2e919ed5927f0"
            }
          ],
          "selected_option": {
            "external_id": "001",
            "name": "Ground",
            "shipment_type": "SHIPPING_OPTION_TYPE_OTHER",
            "cost": "7.59",
            "tax": "0.4",
            "total": "7.99"
          }
        }
      ],
      "total_amount": "192.14",
      "sub_total": "175",
      "total_discounts": "0",
      "total_tax": "9.15",
      "total_shipping": "7.99"
    }
  }
}
```
</p>
</details>